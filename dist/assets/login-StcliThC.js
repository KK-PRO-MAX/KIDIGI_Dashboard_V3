import{m as s,ad as h,q as w,r as d,a as y,d as n,ae as I,$ as m,af as p,t as D,J as S,b as x,_ as B}from"./index-CZ0eQXdI.js";import{a as L}from"./index-B9ygI19o.js";const T="/assets/1_2-BzBJk6aU.png",f=L.create({baseURL:void 0,timeout:1e4,headers:{"Content-Type":"application/json"}});f.interceptors.request.use(e=>{const a=localStorage.getItem("token");return a&&(e.headers.Authorization=`Bearer ${a}`),e},e=>(console.error("Request error:",e),Promise.reject(e)));f.interceptors.response.use(e=>e,e=>{var a;if(e.response)switch(e.response.status){case 401:localStorage.removeItem("token"),localStorage.removeItem("userInfo"),localStorage.removeItem("isAuthenticated"),h.push("/login"),s.error("登录已过期，请重新登录");break;case 403:s.error("没有权限访问");break;case 404:s.error("请求的资源不存在");break;case 500:s.error("服务器错误");break;default:s.error(((a=e.response.data)==null?void 0:a.msg)||"请求失败")}else e.code==="ECONNABORTED"?s.error("请求超时，请稍后重试"):s.error("网络错误，请检查网络连接");return Promise.reject(e)});const q=e=>new Promise(a=>setTimeout(a,e));function A(e){return O(e)}async function O(e){return await q(500),e.account==="admin"&&e.password==="admin123"?{data:{ret:0,code:"200",msg:"登录成功",ret_data:{token:"mock-token-"+Date.now(),uid:"1",type:"admin",menu:[]},timestamp:Date.now()},status:200,statusText:"OK",headers:{},config:{}}:{data:{ret:1,code:"400",msg:"用户名或密码错误",ret_data:null,timestamp:Date.now()},status:200,statusText:"OK",headers:{},config:{}}}const P={class:"login-container"},U={class:"form-container"},E=["disabled"],M=w({__name:"login",setup(e){const a=S(),l=d(""),i=d(""),c=d(!1),g=async()=>{var u;if(!l.value||!i.value){s.error("请输入账号和密码");return}try{c.value=!0;const t={account:l.value,password:i.value},o=await A(t);if(console.log("登录响应：",o.data),o.data.ret===0&&o.data.code==="200"){const{token:r,uid:v,type:k,menu:_}=o.data.ret_data||{};r&&localStorage.setItem("token",r);const b={uid:v,type:k,account:l.value,menu:_};localStorage.setItem("userInfo",JSON.stringify(b)),localStorage.setItem("isAuthenticated","true"),s.success("Login successful！"),a.push("/dashboard")}else{let r="登录失败";switch(o.data.code){case"201":r="用户不存在";break;case"400":r="密码错误";break;default:r=o.data.msg||"登录失败"}s.error(r)}}catch(t){console.error("登录错误：",t),t.response?s.error(((u=t.response.data)==null?void 0:u.msg)||"登录失败，请稍后重试"):s.error("网络错误，请检查网络连接")}finally{c.value=!1}};return(u,t)=>(x(),y("div",P,[t[3]||(t[3]=n("img",{src:T,alt:"HonestWaves Icon",class:"login-icon"},null,-1)),n("div",U,[t[2]||(t[2]=n("h2",{class:"sub-title"},"Admin Portal",-1)),n("form",{class:"login-form",onSubmit:I(g,["prevent"])},[m(n("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>l.value=o),type:"text",class:"form-input",placeholder:"Username",required:""},null,512),[[p,l.value]]),m(n("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>i.value=o),type:"password",class:"form-input",placeholder:"Password",required:""},null,512),[[p,i.value]]),n("button",{type:"submit",class:"login-btn",disabled:c.value},D(c.value?"Loading...":"Login"),9,E)],32)])]))}}),j=B(M,[["__scopeId","data-v-29ae5e85"]]);export{j as default};
